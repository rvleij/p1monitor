{"version":3,"sources":["?","../client/js/util.js","../client/js/export.js","../client/js/version.js","../client/js/features.js","../client/js/promise.js","../client/js/dnd.js"],"names":["global","qq","element","hide","style","display","this","attach","type","fn","addEventListener","attachEvent","detach","removeEventListener","detachEvent","contains","descendant","compareDocumentPosition","insertBefore","elementB","parentNode","remove","removeChild","css","styles","Error","opacity","filter","Math","round","extend","hasClass","name","considerParent","re","RegExp","test","className","addClass","removeClass","replace","getByClass","first","candidates","result","querySelector","querySelectorAll","getElementsByTagName","each","idx","val","push","getFirstByClass","children","child","firstChild","nodeType","nextSibling","setText","text","innerText","textContent","clearText","hasAttribute","attrName","attrVal","exec","getAttribute","undefined","canvasToBlob","canvas","mime","quality","dataUriToBlob","toDataURL","dataUri","arrayBuffer","byteString","intArray","mimeString","createBlob","data","BlobBuilder","window","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","blobBuilder","append","getBlob","Blob","split","indexOf","atob","decodeURI","ArrayBuffer","length","Uint8Array","character","charCodeAt","log","message","level","console","isObject","variable","Object","prototype","toString","call","isFunction","isArray","value","buffer","constructor","isItemList","maybeItemList","isNodeList","maybeNodeList","item","namedItem","isString","maybeString","trimStr","string","String","trim","format","str","args","Array","slice","arguments","newStr","nextIdxToReplace","substring","isFile","maybeFile","File","isFileList","maybeFileList","FileList","isFileOrInput","maybeFileOrInput","isInput","maybeInput","notFile","evaluateType","normalizedType","toLowerCase","HTMLInputElement","tagName","isBlob","maybeBlob","isXhrUploadSupported","input","document","createElement","multiple","FormData","createXhrInstance","upload","XMLHttpRequest","ActiveXObject","error","isFolderDropSupported","dataTransfer","items","webkitGetAsEntry","isFileChunkingSupported","androidStock","webkitSlice","mozSlice","sliceBlob","fileOrBlob","start","end","arrayBufferToHex","bytesAsHex","bytes","byt","byteAsHexStr","readBlobToHex","blob","startOffset","initialBlob","fileReader","FileReader","promise","Promise","onload","success","onerror","failure","readAsArrayBuffer","second","extendNested","prop","override","target","sourceFn","super_","source","srcPropName","srcPropVal","arr","elt","from","len","hasOwnProperty","getUniqueId","c","r","random","ie","navigator","userAgent","ie7","ie8","ie10","ie11","edge","safari","vendor","chrome","opera","firefox","windows","platform","android","ios6","ios","ios7","ios8","ios800","iosChrome","iosSafari","iosSafariWebView","preventDefault","e","returnValue","toElement","div","html","innerHTML","iterableItem","callback","keyOrIndex","retVal","Storage","key","getItem","charAt","bind","oldFunc","context","newArgs","concat","apply","obj2url","obj","temp","prefixDone","uristrings","prefix","add","nextObj","i","nextTemp","encodeURIComponent","join","obj2FormData","formData","arrayKeyName","obj2Inputs","form","setAttribute","appendChild","parseJson","json","JSON","parse","eval","getExtension","filename","extIdx","lastIndexOf","substr","getFilename","blobOrFileInput","fileName","DisposeSupport","disposers","dispose","disposer","shift","addDisposer","disposeFunction","define","amd","module","exports","version","supportedFeatures","testSupportsFileInputElement","tempInput","supported","disabled","ex","isChrome21OrHigher","match","isChrome14OrHigher","isCrossOriginXhrSupported","withCredentials","isXdrSupported","XDomainRequest","isCrossOriginAjaxSupported","isFolderSelectionSupported","webkitdirectory","isLocalStorageSupported","localStorage","setItem","isDragAndDropSupported","span","supportsUploading","supportsUploadingBlobs","supportsFileDrop","supportsAjaxFileUploading","supportsFolderDrop","supportsChunking","supportsResume","supportsUploadViaPaste","supportsUploadCors","supportsDeleteFileXdr","supportsDeleteFileCorsXhr","supportsDeleteFileCors","supportsFolderSelection","supportsImagePreviews","supportsUploadProgress","postMessage","ajaxUploading","blobUploading","canDetermineSize","chunking","deleteFileCors","deleteFileCorsXdr","deleteFileCorsXhr","dialogElement","HTMLDialogElement","fileDrop","folderDrop","folderSelection","imagePreviews","imageValidation","itemSizeValidation","pause","progressBar","resume","scaling","tiffPreviews","unlimitedScaledImageSize","uploading","uploadCors","uploadCustomHeaders","uploadNonMultipart","uploadViaPaste","isGenericPromise","maybePromise","then","successArgs","failureArgs","successCallbacks","failureCallbacks","doneCallbacks","state","onSuccess","onFailure","done","DragAndDrop","o","uploadDroppedFiles","files","uploadDropZone","filesAsArray","options","callbacks","dropLog","dropDisabled","processingDroppedFilesComplete","getElement","traverseFileTree","entry","parseEntryPromise","file","fullPath","indexOfNameInFullPath","qqPath","droppedFiles","fileError","code","isDirectory","getFilesInDirectory","entries","entriesLeft","reader","accumEntries","existingPromise","dirReader","createReader","readEntries","newEntries","setTimeout","handleDataTransfer","pendingFolderPromises","handleDataTransferPromise","processingDroppedFiles","allowMultipleItems","dropError","getAsFile","pop","setupDropzone","dropArea","dropZone","UploadDropZone","HIDE_ZONES_EVENT_NAME","onEnter","classes","dropActive","stopPropagation","onLeaveNotDescendants","onDrop","disposeSupport","uploadDropZones","isFileDrag","dragEvent","fileDrag","types","leavingDocumentOut","relatedTarget","x","y","setupDragDrop","dropZones","dropZoneElements","maybeHideDropZones","HTMLElement","setupExtraDropzone","removeDropzone","dzs","splice","targetEl","errorSpecifics","dragoverShouldBeCanceled","disableDropOutside","dropOutsideDisabled","dropEffect","isValidFileDrag","effectTest","dt","isSafari","effectAllowed","isOrSetDropDisabled","isDisabled","preventDrop","triggerHidezonesEvent","triggerUsingOldApi","hideZonesEvent","createEvent","initEvent","CustomEvent","err","dispatchEvent","attachEvents","effect","onLeave","elementFromPoint","clientX","clientY"],"mappings":"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","file":"dnd.min.js","sourcesContent":[null,"/*globals window, navigator, document, FormData, File, HTMLInputElement, XMLHttpRequest, Blob, Storage, ActiveXObject */\r\n/* jshint -W079 */\r\nvar qq = function(element) {\r\n    \"use strict\";\r\n\r\n    return {\r\n        hide: function() {\r\n            element.style.display = \"none\";\r\n            return this;\r\n        },\r\n\r\n        /** Returns the function which detaches attached event */\r\n        attach: function(type, fn) {\r\n            if (element.addEventListener) {\r\n                element.addEventListener(type, fn, false);\r\n            } else if (element.attachEvent) {\r\n                element.attachEvent(\"on\" + type, fn);\r\n            }\r\n            return function() {\r\n                qq(element).detach(type, fn);\r\n            };\r\n        },\r\n\r\n        detach: function(type, fn) {\r\n            if (element.removeEventListener) {\r\n                element.removeEventListener(type, fn, false);\r\n            } else if (element.attachEvent) {\r\n                element.detachEvent(\"on\" + type, fn);\r\n            }\r\n            return this;\r\n        },\r\n\r\n        contains: function(descendant) {\r\n            // The [W3C spec](http://www.w3.org/TR/domcore/#dom-node-contains)\r\n            // says a `null` (or ostensibly `undefined`) parameter\r\n            // passed into `Node.contains` should result in a false return value.\r\n            // IE7 throws an exception if the parameter is `undefined` though.\r\n            if (!descendant) {\r\n                return false;\r\n            }\r\n\r\n            // compareposition returns false in this case\r\n            if (element === descendant) {\r\n                return true;\r\n            }\r\n\r\n            if (element.contains) {\r\n                return element.contains(descendant);\r\n            } else {\r\n                /*jslint bitwise: true*/\r\n                return !!(descendant.compareDocumentPosition(element) & 8);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Insert this element before elementB.\r\n         */\r\n        insertBefore: function(elementB) {\r\n            elementB.parentNode.insertBefore(element, elementB);\r\n            return this;\r\n        },\r\n\r\n        remove: function() {\r\n            element.parentNode.removeChild(element);\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Sets styles for an element.\r\n         * Fixes opacity in IE6-8.\r\n         */\r\n        css: function(styles) {\r\n            /*jshint eqnull: true*/\r\n            if (element.style == null) {\r\n                throw new qq.Error(\"Can't apply style to node as it is not on the HTMLElement prototype chain!\");\r\n            }\r\n\r\n            /*jshint -W116*/\r\n            if (styles.opacity != null) {\r\n                if (typeof element.style.opacity !== \"string\" && typeof (element.filters) !== \"undefined\") {\r\n                    styles.filter = \"alpha(opacity=\" + Math.round(100 * styles.opacity) + \")\";\r\n                }\r\n            }\r\n            qq.extend(element.style, styles);\r\n\r\n            return this;\r\n        },\r\n\r\n        hasClass: function(name, considerParent) {\r\n            var re = new RegExp(\"(^| )\" + name + \"( |$)\");\r\n            return re.test(element.className) || !!(considerParent && re.test(element.parentNode.className));\r\n        },\r\n\r\n        addClass: function(name) {\r\n            if (!qq(element).hasClass(name)) {\r\n                element.className += \" \" + name;\r\n            }\r\n            return this;\r\n        },\r\n\r\n        removeClass: function(name) {\r\n            var re = new RegExp(\"(^| )\" + name + \"( |$)\");\r\n            element.className = element.className.replace(re, \" \").replace(/^\\s+|\\s+$/g, \"\");\r\n            return this;\r\n        },\r\n\r\n        getByClass: function(className, first) {\r\n            var candidates,\r\n                result = [];\r\n\r\n            if (first && element.querySelector) {\r\n                return element.querySelector(\".\" + className);\r\n            }\r\n            else if (element.querySelectorAll) {\r\n                return element.querySelectorAll(\".\" + className);\r\n            }\r\n\r\n            candidates = element.getElementsByTagName(\"*\");\r\n\r\n            qq.each(candidates, function(idx, val) {\r\n                if (qq(val).hasClass(className)) {\r\n                    result.push(val);\r\n                }\r\n            });\r\n            return first ? result[0] : result;\r\n        },\r\n\r\n        getFirstByClass: function(className) {\r\n            return qq(element).getByClass(className, true);\r\n        },\r\n\r\n        children: function() {\r\n            var children = [],\r\n                child = element.firstChild;\r\n\r\n            while (child) {\r\n                if (child.nodeType === 1) {\r\n                    children.push(child);\r\n                }\r\n                child = child.nextSibling;\r\n            }\r\n\r\n            return children;\r\n        },\r\n\r\n        setText: function(text) {\r\n            element.innerText = text;\r\n            element.textContent = text;\r\n            return this;\r\n        },\r\n\r\n        clearText: function() {\r\n            return qq(element).setText(\"\");\r\n        },\r\n\r\n        // Returns true if the attribute exists on the element\r\n        // AND the value of the attribute is NOT \"false\" (case-insensitive)\r\n        hasAttribute: function(attrName) {\r\n            var attrVal;\r\n\r\n            if (element.hasAttribute) {\r\n\r\n                if (!element.hasAttribute(attrName)) {\r\n                    return false;\r\n                }\r\n\r\n                /*jshint -W116*/\r\n                return (/^false$/i).exec(element.getAttribute(attrName)) == null;\r\n            }\r\n            else {\r\n                attrVal = element[attrName];\r\n\r\n                if (attrVal === undefined) {\r\n                    return false;\r\n                }\r\n\r\n                /*jshint -W116*/\r\n                return (/^false$/i).exec(attrVal) == null;\r\n            }\r\n        }\r\n    };\r\n};\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    qq.canvasToBlob = function(canvas, mime, quality) {\r\n        return qq.dataUriToBlob(canvas.toDataURL(mime, quality));\r\n    };\r\n\r\n    qq.dataUriToBlob = function(dataUri) {\r\n        var arrayBuffer, byteString,\r\n            createBlob = function(data, mime) {\r\n                var BlobBuilder = window.BlobBuilder ||\r\n                        window.WebKitBlobBuilder ||\r\n                        window.MozBlobBuilder ||\r\n                        window.MSBlobBuilder,\r\n                    blobBuilder = BlobBuilder && new BlobBuilder();\r\n\r\n                if (blobBuilder) {\r\n                    blobBuilder.append(data);\r\n                    return blobBuilder.getBlob(mime);\r\n                }\r\n                else {\r\n                    return new Blob([data], {type: mime});\r\n                }\r\n            },\r\n            intArray, mimeString;\r\n\r\n        // convert base64 to raw binary data held in a string\r\n        if (dataUri.split(\",\")[0].indexOf(\"base64\") >= 0) {\r\n            byteString = atob(dataUri.split(\",\")[1]);\r\n        }\r\n        else {\r\n            byteString = decodeURI(dataUri.split(\",\")[1]);\r\n        }\r\n\r\n        // extract the MIME\r\n        mimeString = dataUri.split(\",\")[0]\r\n            .split(\":\")[1]\r\n            .split(\";\")[0];\r\n\r\n        // write the bytes of the binary string to an ArrayBuffer\r\n        arrayBuffer = new ArrayBuffer(byteString.length);\r\n        intArray = new Uint8Array(arrayBuffer);\r\n        qq.each(byteString, function(idx, character) {\r\n            intArray[idx] = character.charCodeAt(0);\r\n        });\r\n\r\n        return createBlob(arrayBuffer, mimeString);\r\n    };\r\n\r\n    qq.log = function(message, level) {\r\n        if (window.console) {\r\n            if (!level || level === \"info\") {\r\n                window.console.log(message);\r\n            }\r\n            else\r\n            {\r\n                if (window.console[level]) {\r\n                    window.console[level](message);\r\n                }\r\n                else {\r\n                    window.console.log(\"<\" + level + \"> \" + message);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    qq.isObject = function(variable) {\r\n        return variable && !variable.nodeType && Object.prototype.toString.call(variable) === \"[object Object]\";\r\n    };\r\n\r\n    qq.isFunction = function(variable) {\r\n        return typeof (variable) === \"function\";\r\n    };\r\n\r\n    /**\r\n     * Check the type of a value.  Is it an \"array\"?\r\n     *\r\n     * @param value value to test.\r\n     * @returns true if the value is an array or associated with an `ArrayBuffer`\r\n     */\r\n    qq.isArray = function(value) {\r\n        return Object.prototype.toString.call(value) === \"[object Array]\" ||\r\n            (value && window.ArrayBuffer && value.buffer && value.buffer.constructor === ArrayBuffer);\r\n    };\r\n\r\n    // Looks for an object on a `DataTransfer` object that is associated with drop events when utilizing the Filesystem API.\r\n    qq.isItemList = function(maybeItemList) {\r\n        return Object.prototype.toString.call(maybeItemList) === \"[object DataTransferItemList]\";\r\n    };\r\n\r\n    // Looks for an object on a `NodeList` or an `HTMLCollection`|`HTMLFormElement`|`HTMLSelectElement`\r\n    // object that is associated with collections of Nodes.\r\n    qq.isNodeList = function(maybeNodeList) {\r\n        return Object.prototype.toString.call(maybeNodeList) === \"[object NodeList]\" ||\r\n            // If `HTMLCollection` is the actual type of the object, we must determine this\r\n            // by checking for expected properties/methods on the object\r\n            (maybeNodeList.item && maybeNodeList.namedItem);\r\n    };\r\n\r\n    qq.isString = function(maybeString) {\r\n        return Object.prototype.toString.call(maybeString) === \"[object String]\";\r\n    };\r\n\r\n    qq.trimStr = function(string) {\r\n        if (String.prototype.trim) {\r\n            return string.trim();\r\n        }\r\n\r\n        return string.replace(/^\\s+|\\s+$/g, \"\");\r\n    };\r\n\r\n    /**\r\n     * @param str String to format.\r\n     * @returns {string} A string, swapping argument values with the associated occurrence of {} in the passed string.\r\n     */\r\n    qq.format = function(str) {\r\n\r\n        var args =  Array.prototype.slice.call(arguments, 1),\r\n            newStr = str,\r\n            nextIdxToReplace = newStr.indexOf(\"{}\");\r\n\r\n        qq.each(args, function(idx, val) {\r\n            var strBefore = newStr.substring(0, nextIdxToReplace),\r\n                strAfter = newStr.substring(nextIdxToReplace + 2);\r\n\r\n            newStr = strBefore + val + strAfter;\r\n            nextIdxToReplace = newStr.indexOf(\"{}\", nextIdxToReplace + val.length);\r\n\r\n            // End the loop if we have run out of tokens (when the arguments exceed the # of tokens)\r\n            if (nextIdxToReplace < 0) {\r\n                return false;\r\n            }\r\n        });\r\n\r\n        return newStr;\r\n    };\r\n\r\n    qq.isFile = function(maybeFile) {\r\n        return window.File && Object.prototype.toString.call(maybeFile) === \"[object File]\";\r\n    };\r\n\r\n    qq.isFileList = function(maybeFileList) {\r\n        return window.FileList && Object.prototype.toString.call(maybeFileList) === \"[object FileList]\";\r\n    };\r\n\r\n    qq.isFileOrInput = function(maybeFileOrInput) {\r\n        return qq.isFile(maybeFileOrInput) || qq.isInput(maybeFileOrInput);\r\n    };\r\n\r\n    qq.isInput = function(maybeInput, notFile) {\r\n        var evaluateType = function(type) {\r\n            var normalizedType = type.toLowerCase();\r\n\r\n            if (notFile) {\r\n                return normalizedType !== \"file\";\r\n            }\r\n\r\n            return normalizedType === \"file\";\r\n        };\r\n\r\n        if (window.HTMLInputElement) {\r\n            if (Object.prototype.toString.call(maybeInput) === \"[object HTMLInputElement]\") {\r\n                if (maybeInput.type && evaluateType(maybeInput.type)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        if (maybeInput.tagName) {\r\n            if (maybeInput.tagName.toLowerCase() === \"input\") {\r\n                if (maybeInput.type && evaluateType(maybeInput.type)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    qq.isBlob = function(maybeBlob) {\r\n        if (window.Blob && Object.prototype.toString.call(maybeBlob) === \"[object Blob]\") {\r\n            return true;\r\n        }\r\n    };\r\n\r\n    qq.isXhrUploadSupported = function() {\r\n        var input = document.createElement(\"input\");\r\n        input.type = \"file\";\r\n\r\n        return (\r\n            input.multiple !== undefined &&\r\n                typeof File !== \"undefined\" &&\r\n                typeof FormData !== \"undefined\" &&\r\n                typeof (qq.createXhrInstance()).upload !== \"undefined\");\r\n    };\r\n\r\n    // Fall back to ActiveX is native XHR is disabled (possible in any version of IE).\r\n    qq.createXhrInstance = function() {\r\n        if (window.XMLHttpRequest) {\r\n            return new XMLHttpRequest();\r\n        }\r\n\r\n        try {\r\n            return new ActiveXObject(\"MSXML2.XMLHTTP.3.0\");\r\n        }\r\n        catch (error) {\r\n            qq.log(\"Neither XHR or ActiveX are supported!\", \"error\");\r\n            return null;\r\n        }\r\n    };\r\n\r\n    qq.isFolderDropSupported = function(dataTransfer) {\r\n        return dataTransfer.items &&\r\n            dataTransfer.items.length > 0 &&\r\n            dataTransfer.items[0].webkitGetAsEntry;\r\n    };\r\n\r\n    qq.isFileChunkingSupported = function() {\r\n        return !qq.androidStock() && //Android's stock browser cannot upload Blobs correctly\r\n            qq.isXhrUploadSupported() &&\r\n            (File.prototype.slice !== undefined || File.prototype.webkitSlice !== undefined || File.prototype.mozSlice !== undefined);\r\n    };\r\n\r\n    qq.sliceBlob = function(fileOrBlob, start, end) {\r\n        var slicer = fileOrBlob.slice || fileOrBlob.mozSlice || fileOrBlob.webkitSlice;\r\n\r\n        return slicer.call(fileOrBlob, start, end);\r\n    };\r\n\r\n    qq.arrayBufferToHex = function(buffer) {\r\n        var bytesAsHex = \"\",\r\n            bytes = new Uint8Array(buffer);\r\n\r\n        qq.each(bytes, function(idx, byt) {\r\n            var byteAsHexStr = byt.toString(16);\r\n\r\n            if (byteAsHexStr.length < 2) {\r\n                byteAsHexStr = \"0\" + byteAsHexStr;\r\n            }\r\n\r\n            bytesAsHex += byteAsHexStr;\r\n        });\r\n\r\n        return bytesAsHex;\r\n    };\r\n\r\n    qq.readBlobToHex = function(blob, startOffset, length) {\r\n        var initialBlob = qq.sliceBlob(blob, startOffset, startOffset + length),\r\n            fileReader = new FileReader(),\r\n            promise = new qq.Promise();\r\n\r\n        fileReader.onload = function() {\r\n            promise.success(qq.arrayBufferToHex(fileReader.result));\r\n        };\r\n\r\n        fileReader.onerror = promise.failure;\r\n\r\n        fileReader.readAsArrayBuffer(initialBlob);\r\n\r\n        return promise;\r\n    };\r\n\r\n    qq.extend = function(first, second, extendNested) {\r\n        qq.each(second, function(prop, val) {\r\n            if (extendNested && qq.isObject(val)) {\r\n                if (first[prop] === undefined) {\r\n                    first[prop] = {};\r\n                }\r\n                qq.extend(first[prop], val, true);\r\n            }\r\n            else {\r\n                first[prop] = val;\r\n            }\r\n        });\r\n\r\n        return first;\r\n    };\r\n\r\n    /**\r\n     * Allow properties in one object to override properties in another,\r\n     * keeping track of the original values from the target object.\r\n     *\r\n     * Note that the pre-overriden properties to be overriden by the source will be passed into the `sourceFn` when it is invoked.\r\n     *\r\n     * @param target Update properties in this object from some source\r\n     * @param sourceFn A function that, when invoked, will return properties that will replace properties with the same name in the target.\r\n     * @returns {object} The target object\r\n     */\r\n    qq.override = function(target, sourceFn) {\r\n        var super_ = {},\r\n            source = sourceFn(super_);\r\n\r\n        qq.each(source, function(srcPropName, srcPropVal) {\r\n            if (target[srcPropName] !== undefined) {\r\n                super_[srcPropName] = target[srcPropName];\r\n            }\r\n\r\n            target[srcPropName] = srcPropVal;\r\n        });\r\n\r\n        return target;\r\n    };\r\n\r\n    /**\r\n     * Searches for a given element (elt) in the array, returns -1 if it is not present.\r\n     */\r\n    qq.indexOf = function(arr, elt, from) {\r\n        if (arr.indexOf) {\r\n            return arr.indexOf(elt, from);\r\n        }\r\n\r\n        from = from || 0;\r\n        var len = arr.length;\r\n\r\n        if (from < 0) {\r\n            from += len;\r\n        }\r\n\r\n        for (; from < len; from += 1) {\r\n            if (arr.hasOwnProperty(from) && arr[from] === elt) {\r\n                return from;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n\r\n    //this is a version 4 UUID\r\n    qq.getUniqueId = function() {\r\n        return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function(c) {\r\n            /*jslint eqeq: true, bitwise: true*/\r\n            var r = Math.random() * 16 | 0, v = c == \"x\" ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    };\r\n\r\n    //\r\n    // Browsers and platforms detection\r\n    qq.ie = function() {\r\n        return navigator.userAgent.indexOf(\"MSIE\") !== -1 ||\r\n            navigator.userAgent.indexOf(\"Trident\") !== -1;\r\n    };\r\n\r\n    qq.ie7 = function() {\r\n        return navigator.userAgent.indexOf(\"MSIE 7\") !== -1;\r\n    };\r\n\r\n    qq.ie8 = function() {\r\n        return navigator.userAgent.indexOf(\"MSIE 8\") !== -1;\r\n    };\r\n\r\n    qq.ie10 = function() {\r\n        return navigator.userAgent.indexOf(\"MSIE 10\") !== -1;\r\n    };\r\n\r\n    qq.ie11 = function() {\r\n        return qq.ie() && navigator.userAgent.indexOf(\"rv:11\") !== -1;\r\n    };\r\n\r\n    qq.edge = function() {\r\n        return navigator.userAgent.indexOf(\"Edge\") >= 0;\r\n    };\r\n\r\n    qq.safari = function() {\r\n        return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Apple\") !== -1;\r\n    };\r\n\r\n    qq.chrome = function() {\r\n        return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Google\") !== -1;\r\n    };\r\n\r\n    qq.opera = function() {\r\n        return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Opera\") !== -1;\r\n    };\r\n\r\n    qq.firefox = function() {\r\n        return (!qq.edge() && !qq.ie11() && navigator.userAgent.indexOf(\"Mozilla\") !== -1 && navigator.vendor !== undefined && navigator.vendor === \"\");\r\n    };\r\n\r\n    qq.windows = function() {\r\n        return navigator.platform === \"Win32\";\r\n    };\r\n\r\n    qq.android = function() {\r\n        return navigator.userAgent.toLowerCase().indexOf(\"android\") !== -1;\r\n    };\r\n\r\n    // We need to identify the Android stock browser via the UA string to work around various bugs in this browser,\r\n    // such as the one that prevents a `Blob` from being uploaded.\r\n    qq.androidStock = function() {\r\n        return qq.android() && navigator.userAgent.toLowerCase().indexOf(\"chrome\") < 0;\r\n    };\r\n\r\n    qq.ios6 = function() {\r\n        return qq.ios() && navigator.userAgent.indexOf(\" OS 6_\") !== -1;\r\n    };\r\n\r\n    qq.ios7 = function() {\r\n        return qq.ios() && navigator.userAgent.indexOf(\" OS 7_\") !== -1;\r\n    };\r\n\r\n    qq.ios8 = function() {\r\n        return qq.ios() && navigator.userAgent.indexOf(\" OS 8_\") !== -1;\r\n    };\r\n\r\n    // iOS 8.0.0\r\n    qq.ios800 = function() {\r\n        return qq.ios() && navigator.userAgent.indexOf(\" OS 8_0 \") !== -1;\r\n    };\r\n\r\n    qq.ios = function() {\r\n        /*jshint -W014 */\r\n        return navigator.userAgent.indexOf(\"iPad\") !== -1\r\n            || navigator.userAgent.indexOf(\"iPod\") !== -1\r\n            || navigator.userAgent.indexOf(\"iPhone\") !== -1;\r\n    };\r\n\r\n    qq.iosChrome = function() {\r\n        return qq.ios() && navigator.userAgent.indexOf(\"CriOS\") !== -1;\r\n    };\r\n\r\n    qq.iosSafari = function() {\r\n        return qq.ios() && !qq.iosChrome() && navigator.userAgent.indexOf(\"Safari\") !== -1;\r\n    };\r\n\r\n    qq.iosSafariWebView = function() {\r\n        return qq.ios() && !qq.iosChrome() && !qq.iosSafari();\r\n    };\r\n\r\n    //\r\n    // Events\r\n\r\n    qq.preventDefault = function(e) {\r\n        if (e.preventDefault) {\r\n            e.preventDefault();\r\n        } else {\r\n            e.returnValue = false;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Creates and returns element from html string\r\n     * Uses innerHTML to create an element\r\n     */\r\n    qq.toElement = (function() {\r\n        var div = document.createElement(\"div\");\r\n        return function(html) {\r\n            div.innerHTML = html;\r\n            var element = div.firstChild;\r\n            div.removeChild(element);\r\n            return element;\r\n        };\r\n    }());\r\n\r\n    //key and value are passed to callback for each entry in the iterable item\r\n    qq.each = function(iterableItem, callback) {\r\n        var keyOrIndex, retVal;\r\n\r\n        if (iterableItem) {\r\n            // Iterate through [`Storage`](http://www.w3.org/TR/webstorage/#the-storage-interface) items\r\n            if (window.Storage && iterableItem.constructor === window.Storage) {\r\n                for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\r\n                    retVal = callback(iterableItem.key(keyOrIndex), iterableItem.getItem(iterableItem.key(keyOrIndex)));\r\n                    if (retVal === false) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            // `DataTransferItemList` & `NodeList` objects are array-like and should be treated as arrays\r\n            // when iterating over items inside the object.\r\n            else if (qq.isArray(iterableItem) || qq.isItemList(iterableItem) || qq.isNodeList(iterableItem)) {\r\n                for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\r\n                    retVal = callback(keyOrIndex, iterableItem[keyOrIndex]);\r\n                    if (retVal === false) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            else if (qq.isString(iterableItem)) {\r\n                for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\r\n                    retVal = callback(keyOrIndex, iterableItem.charAt(keyOrIndex));\r\n                    if (retVal === false) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                for (keyOrIndex in iterableItem) {\r\n                    if (Object.prototype.hasOwnProperty.call(iterableItem, keyOrIndex)) {\r\n                        retVal = callback(keyOrIndex, iterableItem[keyOrIndex]);\r\n                        if (retVal === false) {\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    //include any args that should be passed to the new function after the context arg\r\n    qq.bind = function(oldFunc, context) {\r\n        if (qq.isFunction(oldFunc)) {\r\n            var args =  Array.prototype.slice.call(arguments, 2);\r\n\r\n            return function() {\r\n                var newArgs = qq.extend([], args);\r\n                if (arguments.length) {\r\n                    newArgs = newArgs.concat(Array.prototype.slice.call(arguments));\r\n                }\r\n                return oldFunc.apply(context, newArgs);\r\n            };\r\n        }\r\n\r\n        throw new Error(\"first parameter must be a function!\");\r\n    };\r\n\r\n    /**\r\n     * obj2url() takes a json-object as argument and generates\r\n     * a querystring. pretty much like jQuery.param()\r\n     *\r\n     * how to use:\r\n     *\r\n     *    `qq.obj2url({a:'b',c:'d'},'http://any.url/upload?otherParam=value');`\r\n     *\r\n     * will result in:\r\n     *\r\n     *    `http://any.url/upload?otherParam=value&a=b&c=d`\r\n     *\r\n     * @param  Object JSON-Object\r\n     * @param  String current querystring-part\r\n     * @return String encoded querystring\r\n     */\r\n    qq.obj2url = function(obj, temp, prefixDone) {\r\n        /*jshint laxbreak: true*/\r\n        var uristrings = [],\r\n            prefix = \"&\",\r\n            add = function(nextObj, i) {\r\n                var nextTemp = temp\r\n                    ? (/\\[\\]$/.test(temp)) // prevent double-encoding\r\n                    ? temp\r\n                    : temp + \"[\" + i + \"]\"\r\n                    : i;\r\n                if ((nextTemp !== \"undefined\") && (i !== \"undefined\")) {\r\n                    uristrings.push(\r\n                        (typeof nextObj === \"object\")\r\n                            ? qq.obj2url(nextObj, nextTemp, true)\r\n                            : (Object.prototype.toString.call(nextObj) === \"[object Function]\")\r\n                            ? encodeURIComponent(nextTemp) + \"=\" + encodeURIComponent(nextObj())\r\n                            : encodeURIComponent(nextTemp) + \"=\" + encodeURIComponent(nextObj)\r\n                    );\r\n                }\r\n            };\r\n\r\n        if (!prefixDone && temp) {\r\n            prefix = (/\\?/.test(temp)) ? (/\\?$/.test(temp)) ? \"\" : \"&\" : \"?\";\r\n            uristrings.push(temp);\r\n            uristrings.push(qq.obj2url(obj));\r\n        } else if ((Object.prototype.toString.call(obj) === \"[object Array]\") && (typeof obj !== \"undefined\")) {\r\n            qq.each(obj, function(idx, val) {\r\n                add(val, idx);\r\n            });\r\n        } else if ((typeof obj !== \"undefined\") && (obj !== null) && (typeof obj === \"object\")) {\r\n            qq.each(obj, function(prop, val) {\r\n                add(val, prop);\r\n            });\r\n        } else {\r\n            uristrings.push(encodeURIComponent(temp) + \"=\" + encodeURIComponent(obj));\r\n        }\r\n\r\n        if (temp) {\r\n            return uristrings.join(prefix);\r\n        } else {\r\n            return uristrings.join(prefix)\r\n                .replace(/^&/, \"\")\r\n                .replace(/%20/g, \"+\");\r\n        }\r\n    };\r\n\r\n    qq.obj2FormData = function(obj, formData, arrayKeyName) {\r\n        if (!formData) {\r\n            formData = new FormData();\r\n        }\r\n\r\n        qq.each(obj, function(key, val) {\r\n            key = arrayKeyName ? arrayKeyName + \"[\" + key + \"]\" : key;\r\n\r\n            if (qq.isObject(val)) {\r\n                qq.obj2FormData(val, formData, key);\r\n            }\r\n            else if (qq.isFunction(val)) {\r\n                formData.append(key, val());\r\n            }\r\n            else {\r\n                formData.append(key, val);\r\n            }\r\n        });\r\n\r\n        return formData;\r\n    };\r\n\r\n    qq.obj2Inputs = function(obj, form) {\r\n        var input;\r\n\r\n        if (!form) {\r\n            form = document.createElement(\"form\");\r\n        }\r\n\r\n        qq.obj2FormData(obj, {\r\n            append: function(key, val) {\r\n                input = document.createElement(\"input\");\r\n                input.setAttribute(\"name\", key);\r\n                input.setAttribute(\"value\", val);\r\n                form.appendChild(input);\r\n            }\r\n        });\r\n\r\n        return form;\r\n    };\r\n\r\n    /**\r\n     * Not recommended for use outside of Fine Uploader since this falls back to an unchecked eval if JSON.parse is not\r\n     * implemented.  For a more secure JSON.parse polyfill, use Douglas Crockford's json2.js.\r\n     */\r\n    qq.parseJson = function(json) {\r\n        /*jshint evil: true*/\r\n        if (window.JSON && qq.isFunction(JSON.parse)) {\r\n            return JSON.parse(json);\r\n        } else {\r\n            return eval(\"(\" + json + \")\");\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Retrieve the extension of a file, if it exists.\r\n     *\r\n     * @param filename\r\n     * @returns {string || undefined}\r\n     */\r\n    qq.getExtension = function(filename) {\r\n        var extIdx = filename.lastIndexOf(\".\") + 1;\r\n\r\n        if (extIdx > 0) {\r\n            return filename.substr(extIdx, filename.length - extIdx);\r\n        }\r\n    };\r\n\r\n    qq.getFilename = function(blobOrFileInput) {\r\n        /*jslint regexp: true*/\r\n\r\n        if (qq.isInput(blobOrFileInput)) {\r\n            // get input value and remove path to normalize\r\n            return blobOrFileInput.value.replace(/.*(\\/|\\\\)/, \"\");\r\n        }\r\n        else if (qq.isFile(blobOrFileInput)) {\r\n            if (blobOrFileInput.fileName !== null && blobOrFileInput.fileName !== undefined) {\r\n                return blobOrFileInput.fileName;\r\n            }\r\n        }\r\n\r\n        return blobOrFileInput.name;\r\n    };\r\n\r\n    /**\r\n     * A generic module which supports object disposing in dispose() method.\r\n     * */\r\n    qq.DisposeSupport = function() {\r\n        var disposers = [];\r\n\r\n        return {\r\n            /** Run all registered disposers */\r\n            dispose: function() {\r\n                var disposer;\r\n                do {\r\n                    disposer = disposers.shift();\r\n                    if (disposer) {\r\n                        disposer();\r\n                    }\r\n                }\r\n                while (disposer);\r\n            },\r\n\r\n            /** Attach event handler and register de-attacher as a disposer */\r\n            attach: function() {\r\n                var args = arguments;\r\n                /*jslint undef:true*/\r\n                this.addDisposer(qq(args[0]).attach.apply(this, Array.prototype.slice.call(arguments, 1)));\r\n            },\r\n\r\n            /** Add disposer to the collection */\r\n            addDisposer: function(disposeFunction) {\r\n                disposers.push(disposeFunction);\r\n            }\r\n        };\r\n    };\r\n}());\r\n","/* globals define, module, global, qq */\r\n(function() {\r\n    \"use strict\";\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(function() {\r\n            return qq;\r\n        });\r\n    }\r\n    else if (typeof module !== \"undefined\" && module.exports) {\r\n        module.exports = qq;\r\n    }\r\n    else {\r\n        global.qq = qq;\r\n    }\r\n}());\r\n","/*global qq */\r\nqq.version = \"5.15.0\";\r\n","/* globals qq */\r\nqq.supportedFeatures = (function() {\r\n    \"use strict\";\r\n\r\n    var supportsUploading,\r\n        supportsUploadingBlobs,\r\n        supportsFileDrop,\r\n        supportsAjaxFileUploading,\r\n        supportsFolderDrop,\r\n        supportsChunking,\r\n        supportsResume,\r\n        supportsUploadViaPaste,\r\n        supportsUploadCors,\r\n        supportsDeleteFileXdr,\r\n        supportsDeleteFileCorsXhr,\r\n        supportsDeleteFileCors,\r\n        supportsFolderSelection,\r\n        supportsImagePreviews,\r\n        supportsUploadProgress;\r\n\r\n    function testSupportsFileInputElement() {\r\n        var supported = true,\r\n            tempInput;\r\n\r\n        try {\r\n            tempInput = document.createElement(\"input\");\r\n            tempInput.type = \"file\";\r\n            qq(tempInput).hide();\r\n\r\n            if (tempInput.disabled) {\r\n                supported = false;\r\n            }\r\n        }\r\n        catch (ex) {\r\n            supported = false;\r\n        }\r\n\r\n        return supported;\r\n    }\r\n\r\n    //only way to test for Filesystem API support since webkit does not expose the DataTransfer interface\r\n    function isChrome21OrHigher() {\r\n        return (qq.chrome() || qq.opera()) &&\r\n            navigator.userAgent.match(/Chrome\\/[2][1-9]|Chrome\\/[3-9][0-9]/) !== undefined;\r\n    }\r\n\r\n    //only way to test for complete Clipboard API support at this time\r\n    function isChrome14OrHigher() {\r\n        return (qq.chrome() || qq.opera()) &&\r\n            navigator.userAgent.match(/Chrome\\/[1][4-9]|Chrome\\/[2-9][0-9]/) !== undefined;\r\n    }\r\n\r\n    //Ensure we can send cross-origin `XMLHttpRequest`s\r\n    function isCrossOriginXhrSupported() {\r\n        if (window.XMLHttpRequest) {\r\n            var xhr = qq.createXhrInstance();\r\n\r\n            //Commonly accepted test for XHR CORS support.\r\n            return xhr.withCredentials !== undefined;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    //Test for (terrible) cross-origin ajax transport fallback for IE9 and IE8\r\n    function isXdrSupported() {\r\n        return window.XDomainRequest !== undefined;\r\n    }\r\n\r\n    // CORS Ajax requests are supported if it is either possible to send credentialed `XMLHttpRequest`s,\r\n    // or if `XDomainRequest` is an available alternative.\r\n    function isCrossOriginAjaxSupported() {\r\n        if (isCrossOriginXhrSupported()) {\r\n            return true;\r\n        }\r\n\r\n        return isXdrSupported();\r\n    }\r\n\r\n    function isFolderSelectionSupported() {\r\n        // We know that folder selection is only supported in Chrome via this proprietary attribute for now\r\n        return document.createElement(\"input\").webkitdirectory !== undefined;\r\n    }\r\n\r\n    function isLocalStorageSupported() {\r\n        try {\r\n            return !!window.localStorage &&\r\n                // unpatched versions of IE10/11 have buggy impls of localStorage where setItem is a string\r\n                qq.isFunction(window.localStorage.setItem);\r\n        }\r\n        catch (error) {\r\n            // probably caught a security exception, so no localStorage for you\r\n            return false;\r\n        }\r\n    }\r\n\r\n    function isDragAndDropSupported() {\r\n        var span = document.createElement(\"span\");\r\n\r\n        return (\"draggable\" in span || (\"ondragstart\" in span && \"ondrop\" in span)) &&\r\n            !qq.android() && !qq.ios();\r\n    }\r\n\r\n    supportsUploading = testSupportsFileInputElement();\r\n\r\n    supportsAjaxFileUploading = supportsUploading && qq.isXhrUploadSupported();\r\n\r\n    supportsUploadingBlobs = supportsAjaxFileUploading && !qq.androidStock();\r\n\r\n    supportsFileDrop = supportsAjaxFileUploading && isDragAndDropSupported();\r\n\r\n    supportsFolderDrop = supportsFileDrop && isChrome21OrHigher();\r\n\r\n    supportsChunking = supportsAjaxFileUploading && qq.isFileChunkingSupported();\r\n\r\n    supportsResume = supportsAjaxFileUploading && supportsChunking && isLocalStorageSupported();\r\n\r\n    supportsUploadViaPaste = supportsAjaxFileUploading && isChrome14OrHigher();\r\n\r\n    supportsUploadCors = supportsUploading && (window.postMessage !== undefined || supportsAjaxFileUploading);\r\n\r\n    supportsDeleteFileCorsXhr = isCrossOriginXhrSupported();\r\n\r\n    supportsDeleteFileXdr = isXdrSupported();\r\n\r\n    supportsDeleteFileCors = isCrossOriginAjaxSupported();\r\n\r\n    supportsFolderSelection = isFolderSelectionSupported();\r\n\r\n    supportsImagePreviews = supportsAjaxFileUploading && window.FileReader !== undefined;\r\n\r\n    supportsUploadProgress = (function() {\r\n        if (supportsAjaxFileUploading) {\r\n            return !qq.androidStock() && !qq.iosChrome();\r\n        }\r\n        return false;\r\n    }());\r\n\r\n    return {\r\n        ajaxUploading: supportsAjaxFileUploading,\r\n        blobUploading: supportsUploadingBlobs,\r\n        canDetermineSize: supportsAjaxFileUploading,\r\n        chunking: supportsChunking,\r\n        deleteFileCors: supportsDeleteFileCors,\r\n        deleteFileCorsXdr: supportsDeleteFileXdr, //NOTE: will also return true in IE10, where XDR is also supported\r\n        deleteFileCorsXhr: supportsDeleteFileCorsXhr,\r\n        dialogElement: !!window.HTMLDialogElement,\r\n        fileDrop: supportsFileDrop,\r\n        folderDrop: supportsFolderDrop,\r\n        folderSelection: supportsFolderSelection,\r\n        imagePreviews: supportsImagePreviews,\r\n        imageValidation: supportsImagePreviews,\r\n        itemSizeValidation: supportsAjaxFileUploading,\r\n        pause: supportsChunking,\r\n        progressBar: supportsUploadProgress,\r\n        resume: supportsResume,\r\n        scaling: supportsImagePreviews && supportsUploadingBlobs,\r\n        tiffPreviews: qq.safari(), // Not the best solution, but simple and probably accurate enough (for now)\r\n        unlimitedScaledImageSize: !qq.ios(), // false simply indicates that there is some known limit\r\n        uploading: supportsUploading,\r\n        uploadCors: supportsUploadCors,\r\n        uploadCustomHeaders: supportsAjaxFileUploading,\r\n        uploadNonMultipart: supportsAjaxFileUploading,\r\n        uploadViaPaste: supportsUploadViaPaste\r\n    };\r\n\r\n}());\r\n","/*globals qq*/\r\n\r\n// Is the passed object a promise instance?\r\nqq.isGenericPromise = function(maybePromise) {\r\n    \"use strict\";\r\n    return !!(maybePromise && maybePromise.then && qq.isFunction(maybePromise.then));\r\n};\r\n\r\nqq.Promise = function() {\r\n    \"use strict\";\r\n\r\n    var successArgs, failureArgs,\r\n        successCallbacks = [],\r\n        failureCallbacks = [],\r\n        doneCallbacks = [],\r\n        state = 0;\r\n\r\n    qq.extend(this, {\r\n        then: function(onSuccess, onFailure) {\r\n            if (state === 0) {\r\n                if (onSuccess) {\r\n                    successCallbacks.push(onSuccess);\r\n                }\r\n                if (onFailure) {\r\n                    failureCallbacks.push(onFailure);\r\n                }\r\n            }\r\n            else if (state === -1) {\r\n                onFailure && onFailure.apply(null, failureArgs);\r\n            }\r\n            else if (onSuccess) {\r\n                onSuccess.apply(null, successArgs);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        done: function(callback) {\r\n            if (state === 0) {\r\n                doneCallbacks.push(callback);\r\n            }\r\n            else {\r\n                callback.apply(null, failureArgs === undefined ? successArgs : failureArgs);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        success: function() {\r\n            state = 1;\r\n            successArgs = arguments;\r\n\r\n            if (successCallbacks.length) {\r\n                qq.each(successCallbacks, function(idx, callback) {\r\n                    callback.apply(null, successArgs);\r\n                });\r\n            }\r\n\r\n            if (doneCallbacks.length) {\r\n                qq.each(doneCallbacks, function(idx, callback) {\r\n                    callback.apply(null, successArgs);\r\n                });\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        failure: function() {\r\n            state = -1;\r\n            failureArgs = arguments;\r\n\r\n            if (failureCallbacks.length) {\r\n                qq.each(failureCallbacks, function(idx, callback) {\r\n                    callback.apply(null, failureArgs);\r\n                });\r\n            }\r\n\r\n            if (doneCallbacks.length) {\r\n                qq.each(doneCallbacks, function(idx, callback) {\r\n                    callback.apply(null, failureArgs);\r\n                });\r\n            }\r\n\r\n            return this;\r\n        }\r\n    });\r\n};\r\n","/*globals qq, document, CustomEvent*/\r\nqq.DragAndDrop = function(o) {\r\n    \"use strict\";\r\n\r\n    var options,\r\n        HIDE_ZONES_EVENT_NAME = \"qq-hidezones\",\r\n        HIDE_BEFORE_ENTER_ATTR = \"qq-hide-dropzone\",\r\n        uploadDropZones = [],\r\n        droppedFiles = [],\r\n        disposeSupport = new qq.DisposeSupport();\r\n\r\n    options = {\r\n        dropZoneElements: [],\r\n        allowMultipleItems: true,\r\n        classes: {\r\n            dropActive: null\r\n        },\r\n        callbacks: new qq.DragAndDrop.callbacks()\r\n    };\r\n\r\n    qq.extend(options, o, true);\r\n\r\n    function uploadDroppedFiles(files, uploadDropZone) {\r\n        // We need to convert the `FileList` to an actual `Array` to avoid iteration issues\r\n        var filesAsArray = Array.prototype.slice.call(files);\r\n\r\n        options.callbacks.dropLog(\"Grabbed \" + files.length + \" dropped files.\");\r\n        uploadDropZone.dropDisabled(false);\r\n        options.callbacks.processingDroppedFilesComplete(filesAsArray, uploadDropZone.getElement());\r\n    }\r\n\r\n    function traverseFileTree(entry) {\r\n        var parseEntryPromise = new qq.Promise();\r\n\r\n        if (entry.isFile) {\r\n            entry.file(function(file) {\r\n                var name = entry.name,\r\n                    fullPath = entry.fullPath,\r\n                    indexOfNameInFullPath = fullPath.indexOf(name);\r\n\r\n                // remove file name from full path string\r\n                fullPath = fullPath.substr(0, indexOfNameInFullPath);\r\n\r\n                // remove leading slash in full path string\r\n                if (fullPath.charAt(0) === \"/\") {\r\n                    fullPath = fullPath.substr(1);\r\n                }\r\n\r\n                file.qqPath = fullPath;\r\n                droppedFiles.push(file);\r\n                parseEntryPromise.success();\r\n            },\r\n            function(fileError) {\r\n                options.callbacks.dropLog(\"Problem parsing '\" + entry.fullPath + \"'.  FileError code \" + fileError.code + \".\", \"error\");\r\n                parseEntryPromise.failure();\r\n            });\r\n        }\r\n        else if (entry.isDirectory) {\r\n            getFilesInDirectory(entry).then(\r\n                function allEntriesRead(entries) {\r\n                    var entriesLeft = entries.length;\r\n\r\n                    qq.each(entries, function(idx, entry) {\r\n                        traverseFileTree(entry).done(function() {\r\n                            entriesLeft -= 1;\r\n\r\n                            if (entriesLeft === 0) {\r\n                                parseEntryPromise.success();\r\n                            }\r\n                        });\r\n                    });\r\n\r\n                    if (!entries.length) {\r\n                        parseEntryPromise.success();\r\n                    }\r\n                },\r\n\r\n                function readFailure(fileError) {\r\n                    options.callbacks.dropLog(\"Problem parsing '\" + entry.fullPath + \"'.  FileError code \" + fileError.code + \".\", \"error\");\r\n                    parseEntryPromise.failure();\r\n                }\r\n            );\r\n        }\r\n\r\n        return parseEntryPromise;\r\n    }\r\n\r\n    // Promissory.  Guaranteed to read all files in the root of the passed directory.\r\n    function getFilesInDirectory(entry, reader, accumEntries, existingPromise) {\r\n        var promise = existingPromise || new qq.Promise(),\r\n            dirReader = reader || entry.createReader();\r\n\r\n        dirReader.readEntries(\r\n            function readSuccess(entries) {\r\n                var newEntries = accumEntries ? accumEntries.concat(entries) : entries;\r\n\r\n                if (entries.length) {\r\n                    setTimeout(function() { // prevent stack overflow, however unlikely\r\n                        getFilesInDirectory(entry, dirReader, newEntries, promise);\r\n                    }, 0);\r\n                }\r\n                else {\r\n                    promise.success(newEntries);\r\n                }\r\n            },\r\n\r\n            promise.failure\r\n        );\r\n\r\n        return promise;\r\n    }\r\n\r\n    function handleDataTransfer(dataTransfer, uploadDropZone) {\r\n        var pendingFolderPromises = [],\r\n            handleDataTransferPromise = new qq.Promise();\r\n\r\n        options.callbacks.processingDroppedFiles();\r\n        uploadDropZone.dropDisabled(true);\r\n\r\n        if (dataTransfer.files.length > 1 && !options.allowMultipleItems) {\r\n            options.callbacks.processingDroppedFilesComplete([]);\r\n            options.callbacks.dropError(\"tooManyFilesError\", \"\");\r\n            uploadDropZone.dropDisabled(false);\r\n            handleDataTransferPromise.failure();\r\n        }\r\n        else {\r\n            droppedFiles = [];\r\n\r\n            if (qq.isFolderDropSupported(dataTransfer)) {\r\n                qq.each(dataTransfer.items, function(idx, item) {\r\n                    var entry = item.webkitGetAsEntry();\r\n\r\n                    if (entry) {\r\n                        //due to a bug in Chrome's File System API impl - #149735\r\n                        if (entry.isFile) {\r\n                            droppedFiles.push(item.getAsFile());\r\n                        }\r\n\r\n                        else {\r\n                            pendingFolderPromises.push(traverseFileTree(entry).done(function() {\r\n                                pendingFolderPromises.pop();\r\n                                if (pendingFolderPromises.length === 0) {\r\n                                    handleDataTransferPromise.success();\r\n                                }\r\n                            }));\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                droppedFiles = dataTransfer.files;\r\n            }\r\n\r\n            if (pendingFolderPromises.length === 0) {\r\n                handleDataTransferPromise.success();\r\n            }\r\n        }\r\n\r\n        return handleDataTransferPromise;\r\n    }\r\n\r\n    function setupDropzone(dropArea) {\r\n        var dropZone = new qq.UploadDropZone({\r\n            HIDE_ZONES_EVENT_NAME: HIDE_ZONES_EVENT_NAME,\r\n            element: dropArea,\r\n            onEnter: function(e) {\r\n                qq(dropArea).addClass(options.classes.dropActive);\r\n                e.stopPropagation();\r\n            },\r\n            onLeaveNotDescendants: function(e) {\r\n                qq(dropArea).removeClass(options.classes.dropActive);\r\n            },\r\n            onDrop: function(e) {\r\n                handleDataTransfer(e.dataTransfer, dropZone).then(\r\n                    function() {\r\n                        uploadDroppedFiles(droppedFiles, dropZone);\r\n                    },\r\n                    function() {\r\n                        options.callbacks.dropLog(\"Drop event DataTransfer parsing failed.  No files will be uploaded.\", \"error\");\r\n                    }\r\n                );\r\n            }\r\n        });\r\n\r\n        disposeSupport.addDisposer(function() {\r\n            dropZone.dispose();\r\n        });\r\n\r\n        qq(dropArea).hasAttribute(HIDE_BEFORE_ENTER_ATTR) && qq(dropArea).hide();\r\n\r\n        uploadDropZones.push(dropZone);\r\n\r\n        return dropZone;\r\n    }\r\n\r\n    function isFileDrag(dragEvent) {\r\n        var fileDrag;\r\n\r\n        qq.each(dragEvent.dataTransfer.types, function(key, val) {\r\n            if (val === \"Files\") {\r\n                fileDrag = true;\r\n                return false;\r\n            }\r\n        });\r\n\r\n        return fileDrag;\r\n    }\r\n\r\n    // Attempt to determine when the file has left the document.  It is not always possible to detect this\r\n    // in all cases, but it is generally possible in all browsers, with a few exceptions.\r\n    //\r\n    // Exceptions:\r\n    // * IE10+ & Safari: We can't detect a file leaving the document if the Explorer window housing the file\r\n    //                   overlays the browser window.\r\n    // * IE10+: If the file is dragged out of the window too quickly, IE does not set the expected values of the\r\n    //          event's X & Y properties.\r\n    function leavingDocumentOut(e) {\r\n        if (qq.firefox()) {\r\n            return !e.relatedTarget;\r\n        }\r\n\r\n        if (qq.safari()) {\r\n            return e.x < 0 || e.y < 0;\r\n        }\r\n\r\n        return e.x === 0 && e.y === 0;\r\n    }\r\n\r\n    function setupDragDrop() {\r\n        var dropZones = options.dropZoneElements,\r\n\r\n            maybeHideDropZones = function() {\r\n                setTimeout(function() {\r\n                    qq.each(dropZones, function(idx, dropZone) {\r\n                        qq(dropZone).hasAttribute(HIDE_BEFORE_ENTER_ATTR) && qq(dropZone).hide();\r\n                        qq(dropZone).removeClass(options.classes.dropActive);\r\n                    });\r\n                }, 10);\r\n            };\r\n\r\n        qq.each(dropZones, function(idx, dropZone) {\r\n            var uploadDropZone = setupDropzone(dropZone);\r\n\r\n            // IE <= 9 does not support the File API used for drag+drop uploads\r\n            if (dropZones.length && qq.supportedFeatures.fileDrop) {\r\n                disposeSupport.attach(document, \"dragenter\", function(e) {\r\n                    if (!uploadDropZone.dropDisabled() && isFileDrag(e)) {\r\n                        qq.each(dropZones, function(idx, dropZone) {\r\n                            // We can't apply styles to non-HTMLElements, since they lack the `style` property.\r\n                            // Also, if the drop zone isn't initially hidden, let's not mess with `style.display`.\r\n                            if (dropZone instanceof HTMLElement &&\r\n                                qq(dropZone).hasAttribute(HIDE_BEFORE_ENTER_ATTR)) {\r\n\r\n                                qq(dropZone).css({display: \"block\"});\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        disposeSupport.attach(document, \"dragleave\", function(e) {\r\n            if (leavingDocumentOut(e)) {\r\n                maybeHideDropZones();\r\n            }\r\n        });\r\n\r\n        // Just in case we were not able to detect when a dragged file has left the document,\r\n        // hide all relevant drop zones the next time the mouse enters the document.\r\n        // Note that mouse events such as this one are not fired during drag operations.\r\n        disposeSupport.attach(qq(document).children()[0], \"mouseenter\", function(e) {\r\n            maybeHideDropZones();\r\n        });\r\n\r\n        disposeSupport.attach(document, \"drop\", function(e) {\r\n            e.preventDefault();\r\n            maybeHideDropZones();\r\n        });\r\n\r\n        disposeSupport.attach(document, HIDE_ZONES_EVENT_NAME, maybeHideDropZones);\r\n    }\r\n\r\n    setupDragDrop();\r\n\r\n    qq.extend(this, {\r\n        setupExtraDropzone: function(element) {\r\n            options.dropZoneElements.push(element);\r\n            setupDropzone(element);\r\n        },\r\n\r\n        removeDropzone: function(element) {\r\n            var i,\r\n                dzs = options.dropZoneElements;\r\n\r\n            for (i in dzs) {\r\n                if (dzs[i] === element) {\r\n                    return dzs.splice(i, 1);\r\n                }\r\n            }\r\n        },\r\n\r\n        dispose: function() {\r\n            disposeSupport.dispose();\r\n            qq.each(uploadDropZones, function(idx, dropZone) {\r\n                dropZone.dispose();\r\n            });\r\n        }\r\n    });\r\n};\r\n\r\nqq.DragAndDrop.callbacks = function() {\r\n    \"use strict\";\r\n\r\n    return {\r\n        processingDroppedFiles: function() {},\r\n        processingDroppedFilesComplete: function(files, targetEl) {},\r\n        dropError: function(code, errorSpecifics) {\r\n            qq.log(\"Drag & drop error code '\" + code + \" with these specifics: '\" + errorSpecifics + \"'\", \"error\");\r\n        },\r\n        dropLog: function(message, level) {\r\n            qq.log(message, level);\r\n        }\r\n    };\r\n};\r\n\r\nqq.UploadDropZone = function(o) {\r\n    \"use strict\";\r\n\r\n    var disposeSupport = new qq.DisposeSupport(),\r\n        options, element, preventDrop, dropOutsideDisabled;\r\n\r\n    options = {\r\n        element: null,\r\n        onEnter: function(e) {},\r\n        onLeave: function(e) {},\r\n        // is not fired when leaving element by hovering descendants\r\n        onLeaveNotDescendants: function(e) {},\r\n        onDrop: function(e) {}\r\n    };\r\n\r\n    qq.extend(options, o);\r\n    element = options.element;\r\n\r\n    function dragoverShouldBeCanceled() {\r\n        return qq.safari() || (qq.firefox() && qq.windows());\r\n    }\r\n\r\n    function disableDropOutside(e) {\r\n        // run only once for all instances\r\n        if (!dropOutsideDisabled) {\r\n\r\n            // for these cases we need to catch onDrop to reset dropArea\r\n            if (dragoverShouldBeCanceled) {\r\n                disposeSupport.attach(document, \"dragover\", function(e) {\r\n                    e.preventDefault();\r\n                });\r\n            } else {\r\n                disposeSupport.attach(document, \"dragover\", function(e) {\r\n                    if (e.dataTransfer) {\r\n                        e.dataTransfer.dropEffect = \"none\";\r\n                        e.preventDefault();\r\n                    }\r\n                });\r\n            }\r\n\r\n            dropOutsideDisabled = true;\r\n        }\r\n    }\r\n\r\n    function isValidFileDrag(e) {\r\n        // e.dataTransfer currently causing IE errors\r\n        // IE9 does NOT support file API, so drag-and-drop is not possible\r\n        if (!qq.supportedFeatures.fileDrop) {\r\n            return false;\r\n        }\r\n\r\n        var effectTest, dt = e.dataTransfer,\r\n        // do not check dt.types.contains in webkit, because it crashes safari 4\r\n        isSafari = qq.safari();\r\n\r\n        // dt.effectAllowed is none in Safari 5\r\n        // dt.types.contains check is for firefox\r\n\r\n        // dt.effectAllowed crashes IE 11 & 10 when files have been dragged from\r\n        // the filesystem\r\n        effectTest = qq.ie() && qq.supportedFeatures.fileDrop ? true : dt.effectAllowed !== \"none\";\r\n        return dt && effectTest && (dt.files || (!isSafari && dt.types.contains && dt.types.contains(\"Files\")));\r\n    }\r\n\r\n    function isOrSetDropDisabled(isDisabled) {\r\n        if (isDisabled !== undefined) {\r\n            preventDrop = isDisabled;\r\n        }\r\n        return preventDrop;\r\n    }\r\n\r\n    function triggerHidezonesEvent() {\r\n        var hideZonesEvent;\r\n\r\n        function triggerUsingOldApi() {\r\n            hideZonesEvent = document.createEvent(\"Event\");\r\n            hideZonesEvent.initEvent(options.HIDE_ZONES_EVENT_NAME, true, true);\r\n        }\r\n\r\n        if (window.CustomEvent) {\r\n            try {\r\n                hideZonesEvent = new CustomEvent(options.HIDE_ZONES_EVENT_NAME);\r\n            }\r\n            catch (err) {\r\n                triggerUsingOldApi();\r\n            }\r\n        }\r\n        else {\r\n            triggerUsingOldApi();\r\n        }\r\n\r\n        document.dispatchEvent(hideZonesEvent);\r\n    }\r\n\r\n    function attachEvents() {\r\n        disposeSupport.attach(element, \"dragover\", function(e) {\r\n            if (!isValidFileDrag(e)) {\r\n                return;\r\n            }\r\n\r\n            // dt.effectAllowed crashes IE 11 & 10 when files have been dragged from\r\n            // the filesystem\r\n            var effect = qq.ie() && qq.supportedFeatures.fileDrop ? null : e.dataTransfer.effectAllowed;\r\n            if (effect === \"move\" || effect === \"linkMove\") {\r\n                e.dataTransfer.dropEffect = \"move\"; // for FF (only move allowed)\r\n            } else {\r\n                e.dataTransfer.dropEffect = \"copy\"; // for Chrome\r\n            }\r\n\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n        });\r\n\r\n        disposeSupport.attach(element, \"dragenter\", function(e) {\r\n            if (!isOrSetDropDisabled()) {\r\n                if (!isValidFileDrag(e)) {\r\n                    return;\r\n                }\r\n                options.onEnter(e);\r\n            }\r\n        });\r\n\r\n        disposeSupport.attach(element, \"dragleave\", function(e) {\r\n            if (!isValidFileDrag(e)) {\r\n                return;\r\n            }\r\n\r\n            options.onLeave(e);\r\n\r\n            var relatedTarget = document.elementFromPoint(e.clientX, e.clientY);\r\n            // do not fire when moving a mouse over a descendant\r\n            if (qq(this).contains(relatedTarget)) {\r\n                return;\r\n            }\r\n\r\n            options.onLeaveNotDescendants(e);\r\n        });\r\n\r\n        disposeSupport.attach(element, \"drop\", function(e) {\r\n            if (!isOrSetDropDisabled()) {\r\n                if (!isValidFileDrag(e)) {\r\n                    return;\r\n                }\r\n\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                options.onDrop(e);\r\n\r\n                triggerHidezonesEvent();\r\n            }\r\n        });\r\n    }\r\n\r\n    disableDropOutside();\r\n    attachEvents();\r\n\r\n    qq.extend(this, {\r\n        dropDisabled: function(isDisabled) {\r\n            return isOrSetDropDisabled(isDisabled);\r\n        },\r\n\r\n        dispose: function() {\r\n            disposeSupport.dispose();\r\n        },\r\n\r\n        getElement: function() {\r\n            return element;\r\n        }\r\n    });\r\n};\r\n"]}